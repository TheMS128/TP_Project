@{
    ViewData["Title"] = "Главная";
    
    bool isAdmin = User.IsInRole("Admin");
    bool isTeacher = User.IsInRole("Teacher");
    bool isStudent = User.IsInRole("Student");
}

@if (!User.Identity.IsAuthenticated)
{
    /* --- ВЕРСИЯ ДЛЯ ГОСТЕЙ (Лендинг) --- */
    /* Здесь оставляем центрирование, так как это промо-страница */
    <div class="d-flex flex-column justify-content-center h-100 py-5">
        <div class="row align-items-center mb-5">
            <div class="col-lg-6">
                <h1 class="display-4 fw-bold text-dark mb-3">Дистанционное обучение <span class="text-primary">нового поколения</span></h1>
                <p class="lead text-muted mb-4">
                    Удобная платформа для студентов и преподавателей. Доступ к лекциям, тестирование и отслеживание прогресса.
                </p>
                <div class="d-grid gap-2 d-md-flex justify-content-md-start">
                    <a asp-controller="Account" asp-action="Login" class="btn btn-primary btn-lg px-5 rounded-pill shadow-sm">
                        Начать обучение <i class="bi bi-arrow-right ms-2"></i>
                    </a>
                </div>
            </div>
            <div class="col-lg-6 text-center mt-4 mt-lg-0">
                <i class="bi bi-laptop text-primary opacity-25" style="font-size: 15rem;"></i>
            </div>
        </div>
    </div>
}
else
{
    /* --- ВЕРСИЯ ДЛЯ АВТОРИЗОВАННЫХ (Панель управления) --- */
    
    /* Убрал justify-content-center, добавил py-5 для отступа сверху */
    <div class="d-flex flex-column py-5">
        <div class="row justify-content-center">
            <div class="col-xl-10 col-12"> 
                
                <div class="card border-0 shadow-lg rounded-4 overflow-hidden">
                    
                    <div class="card-header bg-white border-bottom-0 p-4 pb-0 d-flex justify-content-between align-items-end">
                        <div>
                            <h2 class="fw-bold mb-1 text-dark">Привет, @User.Identity.Name!</h2>
                            <p class="text-muted small mb-3">
                                @if (isAdmin) { <text><span class="badge bg-danger me-2">Администратор</span> Управление системой.</text> }
                                else if (isTeacher) { <text><span class="badge bg-primary me-2">Преподаватель</span> Управление контентом.</text> }
                                else { <text><span class="badge bg-success me-2">Студент</span> Обучение.</text> }
                            </p>
                        </div>
                        <div class="text-end d-none d-md-block">
                            <h5 class="fw-bold text-primary mb-0">@DateTime.Now.ToString("d MMMM")</h5>
                            <small class="text-muted">@DateTime.Now.ToString("dddd")</small>
                        </div>
                    </div>

                    <div class="card-body p-4 pt-3">
                        
                        @{
                            string mainController = isAdmin ? "Admin" : "Subjects";
                            string mainAction = isAdmin ? "ManageSubjects" : "Index";
                            string mainTitle = isAdmin ? "Все предметы" : "Мои курсы";
                            string mainDesc = isAdmin ? "Управление списком дисциплин" : "Перейти к обучению и материалам";
                        }

                        <a asp-controller="@mainController" asp-action="@mainAction" class="btn btn-light w-100 p-4 mb-4 text-start border d-flex align-items-center bg-light-hover transition-hover shadow-sm">
                            <div class="bg-primary text-white rounded-circle p-3 me-4 d-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
                                <i class="bi bi-journal-bookmark-fill fs-3"></i>
                            </div>
                            <div class="flex-grow-1">
                                <h4 class="fw-bold mb-1 text-dark">@mainTitle</h4>
                                <p class="text-muted mb-0">@mainDesc</p>
                            </div>
                            <i class="bi bi-arrow-right-circle-fill text-primary display-5 opacity-50 ms-3"></i>
                        </a>

                        @if (isAdmin)
                        {
                            <h6 class="text-uppercase text-muted fw-bold small mb-3 ps-1 border-bottom pb-2">Администрирование</h6>
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <a asp-controller="Admin" asp-action="ManageStudents" class="text-decoration-none">
                                        <div class="card h-100 border bg-light-hover transition-hover p-3 text-center">
                                            <div class="mb-2"><i class="bi bi-people fs-2 text-success"></i></div>
                                            <h6 class="fw-bold text-dark mb-0">Студенты</h6>
                                        </div>
                                    </a>
                                </div>
                                <div class="col-md-4">
                                    <a asp-controller="Admin" asp-action="ManageTeachers" class="text-decoration-none">
                                        <div class="card h-100 border bg-light-hover transition-hover p-3 text-center">
                                            <div class="mb-2"><i class="bi bi-person-video3 fs-2 text-info"></i></div>
                                            <h6 class="fw-bold text-dark mb-0">Преподаватели</h6>
                                        </div>
                                    </a>
                                </div>
                                <div class="col-md-4">
                                    <a asp-controller="Admin" asp-action="CreateSubject" class="text-decoration-none">
                                        <div class="card h-100 border bg-light-hover transition-hover p-3 text-center">
                                            <div class="mb-2"><i class="bi bi-plus-circle-dotted fs-2 text-danger"></i></div>
                                            <h6 class="fw-bold text-dark mb-0">Создать предмет</h6>
                                        </div>
                                    </a>
                                </div>
                                <div class="col-md-12">
                                    <a asp-controller="Admin" asp-action="ManageGroups" class="text-decoration-none">
                                        <div class="card h-100 border bg-light-hover transition-hover p-3 d-flex flex-row align-items-center justify-content-center">
                                            <i class="bi bi-collection fs-3 text-warning me-3"></i>
                                            <h6 class="fw-bold text-dark mb-0">Управление группами студентов</h6>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        }
                        
                        @if (isTeacher)
                        {
                            <h6 class="text-uppercase text-muted fw-bold small mb-3 ps-1 border-bottom pb-2">Преподавание</h6>
                            <div class="alert alert-light border d-flex align-items-center" role="alert">
                                <i class="bi bi-info-circle-fill text-primary fs-4 me-3"></i>
                                <div>
                                    <strong>Совет:</strong> Чтобы добавить лекции или тесты, перейдите в раздел "Мои курсы", выберите предмет и нажмите "Управление".
                                </div>
                            </div>
                        }

                        @if (isStudent)
                        {
                            <h6 class="text-uppercase text-muted fw-bold small mb-3 ps-1 border-bottom pb-2">Статистика</h6>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <div class="card h-100 border bg-light p-3">
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-check2-circle text-success fs-3 me-3"></i>
                                            <div>
                                                <h6 class="fw-bold mb-0">Тесты</h6>
                                                <small class="text-muted">Проверяйте знания регулярно</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card h-100 border bg-light p-3">
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-earmark-text text-primary fs-3 me-3"></i>
                                            <div>
                                                <h6 class="fw-bold mb-0">Лекции</h6>
                                                <small class="text-muted">Материалы доступны 24/7</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }

                    </div>
                </div>

            </div>
        </div>
    </div>
    
    <style>
        .bg-light-hover:hover {
            background-color: #f8f9fa !important;
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            border-color: #dee2e6 !important;
        }
        .transition-hover {
            transition: all 0.2s cubic-bezier(0.165, 0.84, 0.44, 1);
        }
    </style>
}